<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>raphael</title>
	<link rel="stylesheet" href="css/style.css">
</head>
<body>
	<div class="blkUnit grpUnit cMapUnit" id="cMapBox">
    <div class="titlBar">
        <h4>地域分布</h4>
        <i class="icons help" onclick="BID.showHelpTip('hptp_cMap')"></i>
                    <span class="compInfo"></span>
            <span class="compInfo"></span>
            <span class="compInfo"></span>
            <span class="compInfo">PC端</span>
                <div class="ttools">
            <i class="icons shar" title="分享"></i>
        </div>
    </div>
    <div class="stmTabs tabUnit" style="position:relative;z-index:2;overflow:hidden;padding:0;">
        <div class="tabTitle">
            <div class="tabUl tabSkin" style="margin:0 25px;padding-top:20px;" onclick="BID.tabFun()"></div>
        </div>
        <div class="tabConts" style="display:none;"></div>
    </div>
    <div class="grpArea">
        <div class="R_paper"></div>
        <div id="citylevel"></div>
	<div id="areaName" style="display:none;">
	    <span style="margin:50px 0 0 110px;">华东</span>
	    <span style="margin:-60px 0 0 70px;">华北</span>
	    <span style="margin:130px 0 0 50px;">华南</span>
	    <span style="margin:50px 0 0 50px;">华中</span>
	    <span style="margin:55px 0 0 -80px;">西南</span>
	    <span style="margin:-110px 0 0 180px;">东北</span>
	    <span style="margin:-40px 0 0 -120px;">西北</span>
	</div>
        <div class="R_copyright" style="z-index:1;right:25px;bottom:30px;"></div>
    </div>
</div>




	<script type="text/javascript" src="js/raphael.js"></script>
	<script type="text/javascript" src="js/lib.js"></script>
	<script type="text/javascript" src="js/funs.js"></script>
	<script type="text/javascript" src="js/ecmpData.js"></script>
	<script type="text/javascript" src="js/cmap.js"></script>
	<script type="text/javascript">
		T(function () {
            BID.res2(/\//);
    
    
                BID.scroll_resize();

                    BID.placehold('#schword', {cssText: 'padding:9px 40px;color:#d8d8d8;font-size:16px;_padding-top:8px;'});
					BID.newSuggestion('schword', {onconfirm: function (e, o) {
					    var word = T.string(o.data).trim();
					    if(!word){return;}
					    T('#schfm').submit();
					}});

					                    T('#pas_regLink').each(function () {
					    this.href = this.href.split('&')[0] + '&u=' + encodeURIComponent(location.href);
					});
					T('#userbar a.cas_logout').each(function () {
					    this.href = this.href.split('&')[0] + '&u=' + encodeURIComponent(PPval.hostUrl + PPval.routeUrl);
					});

					                     iWfyaffD = 'St4KhXYuHs14bBINNuYFrZlkQqzU4zGobwnrOIVcJ48qooD42E';
					 fNY = iWfyaffD + iWfyaffD.slice(0, 2);
					                        BID.crAdvPannel();
					    BID.fillAdvPannel();
					    BID.splitWord();

					                     twDu = Raphael(-500, -500, 200, 200).path('M14,27R53,23 63,60 42,29 99,57 44,29 51,88 99,80').getPointAtLength(309).alpha.toFixed(3) + fNY;
					            
					    
					                         NsRf = Raphael(-500, -500, 200, 200).path('M14,35R26,62 27,89 22,52 100,49 78,69 23,38').getPointAtLength(96).alpha.toFixed(3) + twDu;
					                T(function () {
					            BID.dataBanner('trend', '', function (data, items) {
					    if(!data || !data.length){return;}
					    BID.crCarousel(T('#banner_trend').show()[0], items);
					});


					var tabnames = $('#compTab li.tabLi > span');
					BID.evts.care('compTab_tabClick', function (index) {
					    $('#currentTabKey').text(index === 0 ? '按关键词' : '按地域');
					})('compTab_tabClick', document.getElementById('compTab'), 0);

					if ( $('#compTab li.curr').index() === 1 ) {
					    $('#currentTabKey').text('地域');
					} 


					        });
					                        var OSR = Raphael(-500, -500, 200, 200).path('M87,49R69,88,17,06,72,17,72,69').getPointAtLength(59).alpha.toFixed(3) + twDu;
					                T(function () {
					            var tplsCtrl = 'Index';
					var mapBoxID = 'cMapBox';
					var params = T.url.queryToJson();
					var iniCbk = function () {};
					    iniCbk = function () {
					        if (iniCbk.called) {return;} else {iniCbk.called = 1;}
					        T('#' + mapBoxID + ' .titlBar .ttools').show().click(function () {
					            var params = {'tpl': 'cMap', 'city': iMap.ctyRegion, 'tag': iMap.tagIndex, 'tab': iMap.tabVal};
					            BID.shareBlockImg(params);
					        });
					    };
					var iMap = _cMap_ini_use({'tplsCtrl': tplsCtrl, mapBoxID: mapBoxID, 'city': params.city, 'tag': params.tag, 'tab': params.tab, funCbk: iniCbk});

					        });
					                         RRQF = NsRf.split('').reverse().join('');
					                T(function () {
					            var iBlock = BID.sentimBlock('crowdsocial').title([]).tabTils([]); 

					BID.dataInterface('Social/getSocial/', '', function (msg) {
					    
					    if ( msg.status !== 0 ){
					        T("#grp_social").html('<div style="padding-top:120px;text-align:center;"><p class="no-data">暂无数据</p></div>')
					        return;
					    }  
					    
					    var series = msg.data || {};

					        if (series[0].str_age === undefined || series[0].str_sex === undefined) {
					            T("#grp_social").html('<div style="padding-top:120px;text-align:center;"><p class="no-data">暂无数据</p></div>')
					            return;
					        }  
					        var agemorecolumnseries = [], sexmorecolumnseries = [[],[]], wordseries=[];

					        for ( var i = 0, ii = series.length; i < ii; i++ ) {
					            var data = series[i] || {}, ageoneseries = [];                                                           
					            var cur_age = data.str_age || {};
					            var k = 0;
					            for ( var j = 1; j <= 5; j++ ) {
					                if ( agemorecolumnseries[k] === undefined ){
					                    agemorecolumnseries[k] = [];
					                } 
					                agemorecolumnseries[k].push(cur_age[j] || 0);                    
					                k++;
					            }
					           
					            var cur_sex = data.str_sex || {};
					            wordseries.push(data.word || "");
					            sexmorecolumnseries[0].push(cur_sex.M || 0);
					            sexmorecolumnseries[1].push(cur_sex.F || 0);
					        }
					        
					        var r0 = G.canvas("grp_social_t", 730, 30);
					        r0.chart("legend", 10, 1, 730, 30, wordseries, { 
					            textlimit : 12    
					        });

					        var r1 = G.canvas("grp_social_l", 380, 270);
					        r1.chart("agecolumn", 0, 40, 380, 270, agemorecolumnseries);
					        
					        var r2 = G.canvas("grp_social_r", 350, 270);
					        r2.chart("sexcolumn", 0, 40, 350, 250, sexmorecolumnseries);

					}, {loading: T('#grp_social').parent()[0]});

					        });
					                    T(function () {
					            BID.rTools_pos('rTools');

					        });
					                         VFk = RRQF + RRQF.slice(0, 2);
					                T(function () {
					            BID.dataBanner('header', '', function (data, items) {
					    if(!data || !data.length){return;}
					    BID.crCarousel(T('#banner_header').show()[0], items);
					});

					        });
					    
					                        var EBG = Raphael(-500, -500, 200, 200).path('M18,31R17,17,69,72,53,95,44,53').getPointAtLength(149).alpha.toFixed(3) + RRQF;
					                     KyEX = VFk.split('').reverse().join('');
					                    var hZLL = Raphael(-500, -500, 200, 200).path('M49,38R21,88,06,44,72,95,53,88').getPointAtLength(108).alpha.toFixed(3) + VFk;
					                     LltE = Raphael(-500, -500, 200, 200).path('M19,35R27,60 33,88 77,83 73,29 38,54 27,85 47,78 47,77 65,57').getPointAtLength(51).alpha.toFixed(3) + KyEX;
					            
					            BID.res2(LltE);
					        BID.res2(NsRf);
					    });

	</script>
</body>
</html>